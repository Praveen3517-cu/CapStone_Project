# .gitpod.yml
tasks:
  - name: Setup Environment
    init: |
      sudo apt-get update
      sudo apt-get install -y wget gnupg python3-pip libxss1 libnss3
      
      # Install Chrome with proper path registration
      wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
      sudo dpkg -i google-chrome-stable_current_amd64.deb || sudo apt-get install -y -f
      sudo rm google-chrome-stable_current_amd64.deb
      
      # Create symbolic links for PATH detection
      sudo ln -s /usr/bin/google-chrome-stable /usr/local/bin/chrome
      sudo ln -s /usr/bin/google-chrome-stable /usr/bin/google-chrome
      
      # Install Python dependencies
      pip install --upgrade pip
      pip install -r requirements.txt

services:
  - name: mongodb
    image: mongo:6.0
    command: [--dbpath, /data/db, --bind_ip_all]
    ports:
      - 27017:27017
    volumes:
      - /workspace/mongo-data:/data/db

vscode:
  extensions:
    - ms-python.python
